具体实现可以同时参考原书的实现部分的内容
